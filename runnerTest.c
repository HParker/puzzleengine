#include <check.h>
#include <stdio.h>
#include "puzzleData.h"

void test_solution(Runtime * rt, int moveCount, int moves[]) {
  printf("%s: ", rt->pd->title);
  int currentLevel = 0;
  for (int i = 0; i < moveCount; i++) {
    if (rt->gameWon == 0) {
      update(rt, moves[i]);
      if (rt->levelIndex > currentLevel) {
        currentLevel = rt->levelIndex;
        printf(".");
      }

    }
  }
  /* if (rt->gameWon == 0) { */
  /*   printf("Game incomplete %i/%i\n", rt->levelIndex, rt->pd->levelCount); */
  /* } */
  printf(".\n");
}

START_TEST (test_runs_stumper)
{
  FILE *file;
  file = fopen("./puzzles/stumper.puzz", "r");
  Runtime rt;
  startGame(&rt, file);

  int moves[] = {
                 RIGHT, // 0
                 LEFT, // 1
                 UP, // 2
                 DOWN, // 3
                 RIGHT, // 4
                 LEFT,
                 DOWN,
                 UP, // 5
                 DOWN,
                 LEFT,
                 UP, // 6
                 DOWN,
                 DOWN,
                 UP,
                 LEFT,
                 RIGHT,
                 RIGHT
  };
  test_solution(&rt, sizeof(moves)/sizeof(moves[0]), moves);

  ck_assert_int_eq(1, rt.gameWon);
  endGame(&rt);
}
END_TEST

START_TEST (test_runs_basic)
{
  FILE *file;
  file = fopen("./puzzles/basic.puzz", "r");
  Runtime rt;
  startGame(&rt, file);

  int moves[] = {
                 DOWN,
                 LEFT,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 LEFT,
                 UP,
                 LEFT,
                 LEFT,
                 DOWN,
                 DOWN,
                 RIGHT,
                 UP,
                 LEFT,
                 UP,
                 RIGHT,
                 UP,
                 UP,
                 LEFT,
                 DOWN,
                 RIGHT,
                 DOWN,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 UP,
                 LEFT,
                 DOWN,
                 LEFT,
                 UP,
                 UP,
                 RIGHT,
                 DOWN,
                 DOWN,
                 LEFT,
                 RIGHT,
                 UP,
                 UP,
                 LEFT,
                 DOWN,
                 UP,
                 UP,
                 LEFT,
                 LEFT,
                 DOWN,
                 DOWN,
                 RIGHT
  };
  test_solution(&rt, sizeof(moves)/sizeof(moves[0]), moves);

  ck_assert_int_eq(1, rt.gameWon);
  endGame(&rt);
}
END_TEST

START_TEST (test_runs_eyeball_walk)
{
  FILE *file;
  file = fopen("./puzzles/eyeball_walk.puzz", "r");
  Runtime rt;
  startGame(&rt, file);

  int moves[] = {
                 DOWN,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 LEFT,
                 LEFT,
                 UP,
                 LEFT,
                 UP,
                 DOWN,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 DOWN,
                 DOWN,
                 DOWN,
                 DOWN,
                 UP,
                 UP,
                 DOWN,
                 DOWN,
                 RIGHT,
                 DOWN,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 LEFT,
                 LEFT
  };
  test_solution(&rt, sizeof(moves)/sizeof(moves[0]), moves);

  ck_assert_int_eq(1, rt.gameWon);
  endGame(&rt);
}
END_TEST

START_TEST (test_runs_block_faker)
{
  FILE *file;
  file = fopen("./puzzles/block_faker.puzz", "r");
  Runtime rt;
  startGame(&rt, file);

  int moves[] = {
                 UP,
                 LEFT,
                 LEFT,
                 UP,
                 LEFT,
                 DOWN,
                 DOWN,
                 DOWN,
                 LEFT,
                 LEFT,
                 UP,
                 UP,
                 UP,
                 RIGHT,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 RIGHT,
                 DOWN,
                 DOWN,
                 RIGHT,
                 DOWN,
                 RIGHT,
                 USE,
                 UP,
                 UP,
                 UP,
                 UP,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 DOWN,
                 DOWN,
                 RIGHT,
                 UP,
                 LEFT,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 RIGHT,
                 DOWN,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 USE,
                 DOWN,
                 RIGHT,
                 DOWN,
                 RIGHT,
                 DOWN,
                 DOWN,
                 RIGHT,
                 DOWN,
                 RIGHT,
                 DOWN,
                 DOWN,
                 DOWN,
                 DOWN,
                 LEFT,
                 LEFT,
                 UP,
                 UP,
                 UP,
                 DOWN,
                 DOWN,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 UP,
                 UP,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 UP,
                 LEFT,
                 LEFT,
                 DOWN,
                 DOWN,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 LEFT,
                 DOWN,
                 DOWN,
                 RIGHT,
                 DOWN,
                 LEFT,
                 LEFT,
                 DOWN,
                 LEFT,
                 UP,
                 RIGHT,
                 UP,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 USE,
                 UP,
                 UP,
                 UP,
                 LEFT,
                 UP,
                 RIGHT,
                 RIGHT,
                 UP,
                 RIGHT,
                 DOWN,
                 LEFT,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 DOWN,
                 LEFT,
                 LEFT,
                 DOWN,
                 LEFT,
                 UP,
                 UP,
                 LEFT,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 UP,
                 UP,
                 LEFT,
                 UP,
                 UP,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 RIGHT,
                 DOWN,
                 DOWN,
                 LEFT,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 DOWN,
                 LEFT,
                 DOWN,
                 DOWN,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 UP,
                 UP,
                 UP,
                 UP,
                 UP,
                 UP,
                 USE,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 DOWN,
                 DOWN,
                 DOWN,
                 USE
  };
  test_solution(&rt, sizeof(moves)/sizeof(moves[0]), moves);

  ck_assert_int_eq(1, rt.gameWon);
  endGame(&rt);
}
END_TEST

START_TEST (test_runs_kettle)
{
  FILE *file;
  file = fopen("./puzzles/kettle.puzz", "r");
  Runtime rt;
  startGame(&rt, file);

  int moves[] = {
                 USE,
                 USE,
                 USE,
                 USE,
                 UP,
                 RIGHT,
                 LEFT,
                 DOWN,
                 USE,
                 USE,
                 UP,
                 LEFT,
                 USE,
                 USE,
                 UP,
                 LEFT,
                 USE,
                 USE,
                 UP,
                 RIGHT,
                 LEFT,
                 DOWN,
                 USE,
                 USE,
                 LEFT,
                 RIGHT,
                 LEFT,
                 UP,
                 DOWN,
                 USE,
                 USE,
                 RIGHT,
                 UP,
                 DOWN,
                 LEFT,
                 USE,
                 USE,
                 UP,
                 RIGHT,
                 LEFT,
                 LEFT,
                 UP,
                 DOWN,
                 USE,
                 USE,
                 RIGHT,
                 LEFT,
                 LEFT,
                 DOWN,
                 UP,
                 UP,
                 USE,
                 USE,
                 DOWN,
                 RIGHT,
                 DOWN,
                 RIGHT,
                 LEFT,
                 UP,
                 LEFT,
                 UP,
                 USE,
                 USE,
                 RIGHT,
                 LEFT,
                 DOWN,
                 RIGHT,
                 UP,
                 UP,
                 LEFT,
                 LEFT,
                 UP,
                 DOWN,
                 USE,
                 USE,
                 LEFT,
                 DOWN,
                 DOWN,
                 RIGHT,
                 UP,
                 UP,
                 UP,
                 LEFT,
                 LEFT,
                 RIGHT,
                 USE,
                 USE,
                 USE
  };

  test_solution(&rt, sizeof(moves)/sizeof(moves[0]), moves);

  ck_assert_int_eq(1, rt.gameWon);
  endGame(&rt);
}
END_TEST

START_TEST (test_runs_constellation_z)
{
  FILE *file;
  file = fopen("./puzzles/constellation_z.puzz", "r");
  Runtime rt;
  startGame(&rt, file);

  int moves[] = {
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 DOWN,
                 DOWN,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 UP,
                 RIGHT,
                 RIGHT,
                 UP,
                 LEFT,
                 LEFT,
                 RIGHT,
                 RIGHT,
                 UP,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 DOWN,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 DOWN,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 LEFT,
                 LEFT,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 UP,
                 UP,
                 UP,
                 UP,
                 LEFT,
                 UP,
                 UP,
                 UP,
                 RIGHT,
                 DOWN,
                 LEFT,
                 UP,
                 UP,
                 RIGHT,
                 UP,
                 UP,
                 UP,
                 LEFT,
                 DOWN,
                 DOWN,
                 DOWN,
                 DOWN,
                 DOWN,
                 DOWN,
                 DOWN,
                 RIGHT,
                 DOWN,
                 DOWN,
                 DOWN,
                 DOWN,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 UP,
                 UP,
                 UP,
                 UP,
                 LEFT,
                 LEFT,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 UP,
                 UP,
                 UP,
                 UP,
                 UP
  };

  test_solution(&rt, sizeof(moves)/sizeof(moves[0]), moves);
  ck_assert_int_eq(10, rt.levelIndex);
  endGame(&rt);
}
END_TEST

START_TEST (test_runs_micro_ban)
{
  FILE *file;
  file = fopen("./puzzles/micro_ban.puzz", "r");
  Runtime rt;
  startGame(&rt, file);

  int moves[] = {
                 USE,
                 DOWN,
                 LEFT,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 LEFT,
                 UP,
                 LEFT,
                 LEFT,
                 DOWN,
                 DOWN,
                 RIGHT,
                 UP,
                 LEFT,
                 UP,
                 RIGHT,
                 UP,
                 UP,
                 LEFT,
                 DOWN,
                 RIGHT,
                 DOWN,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 UP,
                 LEFT,
                 DOWN,
                 LEFT,
                 UP,
                 UP,
                 USE,
                 RIGHT,
                 DOWN,
                 DOWN,
                 LEFT,
                 RIGHT,
                 UP,
                 UP,
                 LEFT,
                 DOWN,
                 UP,
                 UP,
                 LEFT,
                 LEFT,
                 DOWN,
                 DOWN,
                 RIGHT,
                 USE,
                 RIGHT,
                 UP,
                 UP,
                 LEFT,
                 LEFT,
                 LEFT,
                 UP,
                 LEFT,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 DOWN,
                 LEFT,
                 UP,
                 RIGHT,
                 UP,
                 LEFT,
                 LEFT,
                 LEFT,
                 DOWN,
                 DOWN,
                 DOWN,
                 LEFT,
                 LEFT,
                 LEFT,
                 UP,
                 UP,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 RIGHT,
                 DOWN,
                 LEFT,
                 UP,
                 UP,
                 UP,
                 RIGHT,
                 DOWN,
                 DOWN,
                 USE,
                 LEFT,
                 UP,
                 LEFT,
                 LEFT,
                 LEFT,
                 DOWN,
                 RIGHT,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 LEFT,
                 DOWN,
                 LEFT,
                 LEFT,
                 UP,
                 LEFT,
                 LEFT,
                 DOWN,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 DOWN,
                 LEFT,
                 UP,
                 RIGHT,
                 UP,
                 LEFT,
                 LEFT,
                 UP,
                 LEFT,
                 LEFT,
                 LEFT,
                 DOWN,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 DOWN,
                 LEFT,
                 UP,
                 RIGHT,
                 UP,
                 LEFT,
                 USE,
                 LEFT,
                 UP,
                 UP,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 LEFT,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 DOWN,
                 LEFT,
                 UP,
                 DOWN,
                 DOWN,
                 LEFT,
                 LEFT,
                 UP,
                 RIGHT,
                 UP,
                 UP,
                 UP,
                 LEFT,
                 LEFT,
                 DOWN,
                 DOWN,
                 RIGHT,
                 DOWN,
                 DOWN,
                 LEFT,
                 LEFT,
                 UP,
                 RIGHT,
                 USE,
                 DOWN,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 UP,
                 UP,
                 LEFT,
                 UP,
                 LEFT,
                 LEFT,
                 LEFT,
                 DOWN,
                 UP,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 UP,
                 LEFT,
                 LEFT,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 LEFT,
                 LEFT,
                 DOWN,
                 RIGHT,
                 UP,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 DOWN,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 UP,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 DOWN,
                 DOWN,
                 RIGHT,
                 UP,
                 LEFT,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 LEFT,
                 LEFT,
                 LEFT,
                 UP,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 DOWN,
                 DOWN,
                 RIGHT,
                 UP,
                 LEFT,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 UP,
                 LEFT,
                 LEFT,
                 DOWN,
                 UP,
                 DOWN,
                 LEFT,
                 RIGHT,
                 UP,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 LEFT,
                 DOWN,
                 LEFT,
                 LEFT,
                 LEFT,
                 UP,
                 LEFT,
                 LEFT,
                 LEFT,
                 UP,
                 LEFT,
                 LEFT,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 UP,
                 LEFT,
                 LEFT,
                 DOWN,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 LEFT,
                 DOWN,
                 LEFT,
                 LEFT,
                 USE,
                 LEFT,
                 LEFT,
                 UP,
                 DOWN,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 UP,
                 UP,
                 LEFT,
                 LEFT,
                 UP,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 DOWN,
                 DOWN,
                 LEFT,
                 UP,
                 RIGHT,
                 UP,
                 UP,
                 UP,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 DOWN,
                 DOWN,
                 RIGHT,
                 LEFT,
                 DOWN,
                 DOWN,
                 DOWN,
                 UP,
                 UP,
                 RIGHT,
                 RIGHT,
                 LEFT,
                 LEFT,
                 DOWN,
                 DOWN,
                 RIGHT,
                 UP,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 LEFT,
                 USE,
                 LEFT,
                 LEFT,
                 DOWN,
                 DOWN,
                 DOWN,
                 DOWN,
                 DOWN,
                 DOWN,
                 LEFT,
                 DOWN,
                 DOWN,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 LEFT,
                 UP,
                 UP,
                 UP,
                 UP,
                 UP,
                 UP,
                 UP,
                 DOWN,
                 DOWN,
                 DOWN,
                 DOWN,
                 DOWN,
                 DOWN,
                 LEFT,
                 DOWN,
                 UP,
                 UP,
                 RIGHT,
                 UP,
                 UP,
                 UP,
                 UP,
                 UP,
                 UP,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 LEFT,
                 UP,
                 LEFT,
                 LEFT,
                 DOWN,
                 RIGHT,
                 DOWN,
                 DOWN,
                 DOWN,
                 DOWN,
                 DOWN,
                 DOWN,
                 RIGHT,
                 DOWN,
                 DOWN,
                 LEFT,
                 LEFT,
                 UP,
                 UP,
                 RIGHT,
                 UP,
                 UP,
                 UP,
                 UP,
                 UP,
                 UP,
                 UP,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 LEFT,
                 UP,
                 LEFT,
                 DOWN,
                 DOWN,
                 DOWN,
                 DOWN,
                 DOWN,
                 DOWN,
                 LEFT,
                 DOWN,
                 DOWN,
                 LEFT,
                 LEFT,
                 UP,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 RIGHT,
                 LEFT,
                 UP,
                 LEFT,
                 UP,
                 LEFT,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 LEFT,
                 DOWN,
                 RIGHT,
                 DOWN,
                 DOWN,
                 LEFT,
                 LEFT,
                 UP,
                 LEFT,
                 LEFT,
                 UP,
                 UP,
                 RIGHT,
                 RIGHT,
                 LEFT,
                 LEFT,
                 DOWN,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 UP,
                 LEFT,
                 UP,
                 LEFT,
                 UP,
                 UP,
                 UP,
                 UP,
                 UP,
                 UP,
                 LEFT,
                 UP,
                 RIGHT,
                 DOWN,
                 DOWN,
                 DOWN,
                 DOWN,
                 DOWN,
                 DOWN,
                 DOWN,
                 RIGHT,
                 DOWN,
                 LEFT,
                 DOWN,
                 LEFT,
                 LEFT,
                 UP,
                 LEFT,
                 RIGHT,
                 UP,
                 LEFT,
                 DOWN,
                 LEFT,
                 LEFT,
                 UP,
                 UP,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 RIGHT,
                 UP,
                 UP,
                 UP,
                 UP,
                 UP,
                 UP,
                 USE,
                 UP,
                 RIGHT,
                 RIGHT,
                 LEFT,
                 RIGHT,
                 DOWN,
                 UP,
                 LEFT,
                 LEFT,
                 DOWN,
                 RIGHT,
                 UP,
                 RIGHT,
                 DOWN,
                 LEFT,
                 DOWN,
                 DOWN,
                 RIGHT,
                 DOWN,
                 RIGHT,
                 LEFT,
                 UP,
                 LEFT,
                 UP,
                 UP,
                 RIGHT,
                 DOWN,
                 RIGHT,
                 DOWN,
                 DOWN,
                 LEFT,
                 UP,
                 RIGHT,
                 UP,
                 LEFT,
                 DOWN,
                 LEFT,
                 UP,
                 RIGHT,
                 UP,
                 LEFT,
                 USE,
                 RIGHT,
                 DOWN,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 LEFT,
                 LEFT,
                 DOWN,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 LEFT,
                 LEFT,
                 RIGHT,
                 UP,
                 RIGHT,
                 UP,
                 UP,
                 UP,
                 RIGHT,
                 RIGHT,
                 DOWN,
                 DOWN,
                 DOWN,
                 LEFT,
                 LEFT,
                 DOWN,
                 DOWN,
                 LEFT,
                 LEFT,
                 UP,
                 UP,
                 RIGHT,
                 LEFT,
                 DOWN,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 UP,
                 UP,
                 DOWN,
                 DOWN,
                 DOWN,
                 DOWN,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 UP,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 LEFT,
                 DOWN,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 UP,
                 DOWN,
                 DOWN,
                 DOWN,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 UP,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 LEFT,
                 DOWN,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 USE
  };

  test_solution(&rt, sizeof(moves)/sizeof(moves[0]), moves);
  ck_assert_int_eq(1, rt.gameWon);
  endGame(&rt);
}
END_TEST

START_TEST (test_runs_match3)
{
  FILE *file;
  file = fopen("./puzzles/match3.puzz", "r");
  Runtime rt;
  startGame(&rt, file);

  int moves[] = {
                 DOWN,
                 DOWN,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 DOWN,
                 LEFT,
                 UP,
                 LEFT,
                 DOWN,
                 LEFT,
                 UP,
                 UP,
                 LEFT,
                 UP,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 LEFT,
                 UP,
                 LEFT,
                 DOWN,
                 RIGHT,
                 DOWN,
                 LEFT,
                 LEFT,
                 LEFT,
                 DOWN,
                 LEFT,
                 UP,
                 UP
  };

  test_solution(&rt, sizeof(moves)/sizeof(moves[0]), moves);
  ck_assert_int_eq(1, rt.gameWon);
  endGame(&rt);
}
END_TEST

START_TEST (test_runs_neko_puzzle)
{
  FILE *file;
  file = fopen("./puzzles/neko_puzzle.puzz", "r");
  Runtime rt;
  startGame(&rt, file);

  int moves[] = {
                 USE,
                 UP,
                 RIGHT,
                 DOWN,
                 LEFT,
                 UP,
                 USE,
                 DOWN,
                 LEFT,
                 RIGHT,
                 UP,
                 LEFT,
                 USE,
                 LEFT,
                 DOWN,
                 RIGHT,
                 UP,
                 LEFT,
                 RIGHT,
                 USE,
                 UP,
                 DOWN,
                 RIGHT,
                 UP,
                 RIGHT,
                 DOWN,
                 USE,
                 LEFT,
                 DOWN,
                 DOWN,
                 LEFT,
                 UP,
                 LEFT,
                 DOWN,
                 USE,
                 UP,
                 RIGHT,
                 LEFT,
                 DOWN,
                 RIGHT,
                 UP,
                 LEFT,
                 USE,
                 LEFT,
                 RIGHT,
                 DOWN,
                 LEFT,
                 UP,
                 RIGHT,
                 DOWN,
                 USE,
                 LEFT,
                 DOWN,
                 LEFT,
                 RIGHT,
                 DOWN,
                 LEFT,
                 RIGHT,
                 USE,
                 RIGHT,
                 LEFT,
                 DOWN,
                 UP,
                 RIGHT,
                 UP,
                 RIGHT,
                 USE,
                 LEFT,
                 UP,
                 RIGHT,
                 UP,
                 LEFT,
                 DOWN,
                 LEFT,
                 RIGHT,
                 DOWN,
                 USE
  };
  test_solution(&rt, sizeof(moves)/sizeof(moves[0]), moves);

  ck_assert_int_eq(1, rt.gameWon);
  endGame(&rt);
}
END_TEST

START_TEST (test_runs_lime_rick)
{
  FILE *file;
  file = fopen("./puzzles/lime_rick.puzz", "r");
  Runtime rt;
  startGame(&rt, file);

  int moves[] = {
                 USE,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 USE,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 LEFT,
                 UP,
                 RIGHT,
                 UP,
                 LEFT,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 LEFT,
                 UP,
                 RIGHT,
                 UP,
                 LEFT,
                 UP,
                 RIGHT,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 USE,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 RIGHT,
                 UP,
                 RIGHT,
                 RIGHT,
                 UP,
                 LEFT,
                 UP,
                 UP,
                 LEFT,
                 LEFT,
                 UP,
                 LEFT,
                 LEFT,
                 USE,
                 LEFT,
                 LEFT,
                 LEFT,
                 UP,
                 RIGHT,
                 UP,
                 LEFT,
                 UP,
                 RIGHT,
                 UP,
                 LEFT,
                 UP,
                 RIGHT,
                 UP,
                 LEFT,
                 UP,
                 RIGHT,
                 UP,
                 LEFT,
                 UP,
                 RIGHT,
                 UP,
                 LEFT,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 USE,
                 LEFT,
                 LEFT,
                 UP,
                 UP,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 LEFT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 LEFT,
                 LEFT,
                 LEFT,
                 USE,
                 UP,
                 UP,
                 UP,
                 LEFT,
                 LEFT,
                 UP,
                 UP,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 UP,
                 UP,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 LEFT,
                 LEFT,
                 UP,
                 UP,
                 UP,
                 LEFT,
                 LEFT,
                 USE,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 LEFT,
                 UP,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 RIGHT,
                 RIGHT,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 UP,
                 LEFT,
                 LEFT,
                 USE,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 LEFT,
                 LEFT,
                 LEFT,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 USE,
                 UP,
                 UP,
                 UP,
                 RIGHT,
                 UP,
                 LEFT,
                 UP,
                 RIGHT,
                 UP,
                 LEFT,
                 UP,
                 RIGHT,
                 RIGHT,
                 UP,
                 LEFT,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 LEFT,
                 LEFT,
                 LEFT,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 UP,
                 LEFT,
                 UP,
                 RIGHT,
                 RIGHT,
                 USE,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 LEFT,
                 LEFT,
                 LEFT,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 LEFT,
                 LEFT,
                 LEFT,
                 UP,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 LEFT,
                 LEFT,
                 UP,
                 RIGHT,
                 RIGHT,
                 UP,
                 LEFT,
                 LEFT,
                 UP,
                 RIGHT,
                 RIGHT,
                 UP,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 USE
  };
  test_solution(&rt, sizeof(moves)/sizeof(moves[0]), moves);

  ck_assert_int_eq(1, rt.gameWon);
  endGame(&rt);
}
END_TEST

START_TEST (test_runs_not_snake)
{
  FILE *file;
  file = fopen("./puzzles/not_snake.puzz", "r");
  Runtime rt;
  startGame(&rt, file);

  int moves[] = {
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 LEFT,
                 DOWN,
                 LEFT,
                 UP,
                 LEFT,
                 DOWN,
                 LEFT,
                 UP,
                 LEFT,
                 DOWN,
                 DOWN,
                 DOWN,
                 DOWN,
                 RIGHT,
                 UP,
                 RIGHT,
                 DOWN,
                 RIGHT,
                 UP,
                 RIGHT,
                 DOWN,
                 RIGHT,
                 UP,
                 RIGHT,
                 DOWN,
                 RIGHT,
                 UP,
                 UP,
                 UP,
                 UP,
                 LEFT,
                 DOWN
  };
  test_solution(&rt, sizeof(moves)/sizeof(moves[0]), moves);

  ck_assert_int_eq(1, rt.gameWon);
  endGame(&rt);
}
END_TEST

START_TEST (test_runs_octat)
{
  FILE *file;
  file = fopen("./puzzles/octat.puzz", "r");
  Runtime rt;
  startGame(&rt, file);

  int moves[] = {
                 USE,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 USE,
                 RIGHT,
                 RIGHT,
                 UP,
                 UP,
                 LEFT,
                 DOWN,
                 DOWN,
                 LEFT,
                 LEFT,
                 USE,
                 LEFT,
                 UP,
                 LEFT,
                 DOWN,
                 DOWN,
                 LEFT,
                 UP,
                 LEFT,
                 USE,
                 LEFT,
                 UP,
                 LEFT,
                 LEFT,
                 UP,
                 LEFT,
                 DOWN,
                 DOWN,
                 RIGHT,
                 DOWN,
                 LEFT,
                 DOWN,
                 DOWN,
                 LEFT,
                 UP,
                 LEFT,
                 DOWN,
                 RIGHT,
                 UP,
                 UP,
                 LEFT,
                 LEFT,
                 DOWN,
                 RIGHT,
                 UP,
                 UP,
                 USE,
                 UP,
                 UP,
                 LEFT,
                 LEFT,
                 LEFT,
                 LEFT,
                 UP,
                 UP,
                 RIGHT,
                 DOWN,
                 DOWN,
                 RIGHT,
                 DOWN,
                 DOWN,
                 LEFT,
                 UP,
                 LEFT,
                 DOWN,
                 USE
  };
  test_solution(&rt, sizeof(moves)/sizeof(moves[0]), moves);

  ck_assert_int_eq(11, rt.levelIndex);
  endGame(&rt);
}
END_TEST

Suite * puzzle_script_parser_suite(void)
{
  Suite * s;
  TCase * test_Runner;

  s = suite_create("Runner");

  test_Runner = tcase_create("Runner");
  tcase_set_timeout(test_Runner, 100);

  tcase_add_test(test_Runner, test_runs_stumper);
  tcase_add_test(test_Runner, test_runs_basic);
  tcase_add_test(test_Runner, test_runs_eyeball_walk);
  tcase_add_test(test_Runner, test_runs_match3);
  tcase_add_test(test_Runner, test_runs_block_faker);
  tcase_add_test(test_Runner, test_runs_constellation_z);
  tcase_add_test(test_Runner, test_runs_kettle);
  tcase_add_test(test_Runner, test_runs_lime_rick);
  tcase_add_test(test_Runner, test_runs_match3);
  tcase_add_test(test_Runner, test_runs_micro_ban);
  tcase_add_test(test_Runner, test_runs_neko_puzzle);
  tcase_add_test(test_Runner, test_runs_not_snake);
  tcase_add_test(test_Runner, test_runs_octat);
  /* tcase_add_test(test_Runner, test_parses_random_robots); */
  /* tcase_add_test(test_Runner, test_parses_random_robots_spawner); */
  /* tcase_add_test(test_Runner, test_parses_zen_puzzle_garden); */

  suite_add_tcase(s, test_Runner);
  return s;
}


int main(void)
{
  int number_failed;
  Suite *s;
  SRunner *sr;

  s = puzzle_script_parser_suite();
  sr = srunner_create(s);

  srunner_run_all(sr, CK_NORMAL);
  number_failed = srunner_ntests_failed(sr);
  srunner_free(sr);
  return (number_failed == 0) ? 0 : 1;
}
